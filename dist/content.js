let originalBodyClasses="";document.addEventListener("DOMContentLoaded",(()=>{originalBodyClasses=document.body.className,chrome.storage.sync.get(["darkMode","highContrast"],(e=>{e.darkMode&&document.body.classList.add("dark-mode"),e.highContrast&&document.body.classList.add("high-contrast-mode")}))})),chrome.runtime.onMessage.addListener(((e,t,s)=>{if("getParagraphs"===e.action){const e=Array.from(document.getElementsByTagName("p")).map((e=>e.innerText.trim())).filter((e=>e.length>0));if(0===e.length){const t=document.querySelector("article");if(t)e.push(t.innerText.trim());else{const t=document.querySelector("main");t?e.push(t.innerText.trim()):e.push(document.body.innerText.trim())}}s({paragraphs:e})}if("speakText"===e.action){speechSynthesis.cancel();const t=new SpeechSynthesisUtterance(e.text);t.lang=e.lang||"en-US",t.rate=e.rate||1,t.pitch=e.pitch||1;const o=new SpeechSynthesisUtterance("Starting text-to-speech");o.volume=.3,speechSynthesis.speak(o),setTimeout((()=>{speechSynthesis.speak(t)}),500),s({status:"speaking"})}if("pauseSpeech"===e.action&&(speechSynthesis.pause(),s({status:"paused"})),"resumeSpeech"===e.action&&(speechSynthesis.resume(),s({status:"resumed"})),"stopSpeech"===e.action&&(speechSynthesis.cancel(),s({status:"stopped"})),"toggleDarkMode"===e.action){const e=document.body.classList.toggle("dark-mode");chrome.storage.sync.set({darkMode:e}),e&&document.body.classList.contains("high-contrast-mode")&&(document.body.classList.remove("high-contrast-mode"),chrome.storage.sync.set({highContrast:!1})),s({status:"darkModeToggled",active:e})}if("toggleHighContrast"===e.action){const e=document.body.classList.toggle("high-contrast-mode");chrome.storage.sync.set({highContrast:e}),e&&document.body.classList.contains("dark-mode")&&(document.body.classList.remove("dark-mode"),chrome.storage.sync.set({darkMode:!1})),s({status:"highContrastToggled",active:e})}return!0}));
